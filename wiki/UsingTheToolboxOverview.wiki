#summary Brief walkthrough on how to use the toolbox
#labels Featured,Support

<wiki:toc/>

= Using the Toolbox =

This page describes the state of the toolbox at [http://code.google.com/p/imos-toolbox/source/browse/?r=322 revision 322] (19 May 2009 10:22). The trunk changes quickly, so these instructions may already be out of date.

This page gives a brief overview on how to configure and use the toolbox. As development of the toolbox progresses, this page will be updated. Additionally, my aim is to reduce the amount of work required to configure the toolbox.

This page also shows the current state of the toolbox GUI. Feedback, both positive and negative, is more than welcome. Please make criticisms, suggestions and comments, if you have any, so that I can design the GUI to be as useful as possible.

== Configuration ==

Before you can use the toolbox, you must configure the matlab path and deployment database.

=== Matlab path ===

The toolbox root, and every subdirectory within the toolbox root must be on the matlab path. In other words, you must add the following list of directories (valid as of the 19th May 2009) to your matlab path, either by setting the `MATLABPATH` environment variable, or, within matlab, using the 'Set Path' dialog, which is accessed via 'File'->'Set Path'. 

Assuming that the toolbox is installed in `C:\imos-toolbox`, you must add the following directories to the path:
  * `C:\imos-toolbox\`
  * `C:\imos-toolbox\AutomaticQC`
  * `C:\imos-toolbox\DDB`
  * `C:\imos-toolbox\FlowManager`
  * `C:\imos-toolbox\Graph`
  * `C:\imos-toolbox\GUI`
  * `C:\imos-toolbox\IMOS`
  * `C:\imos-toolbox\Java`
  * `C:\imos-toolbox\NetCDF`
  * `C:\imos-toolbox\Parser`
  * `C:\imos-toolbox\Tests` (optional)

=== Deployment Databse ===

Under Windows, the deployment database (hereafter referred to as the ddb) is accessed as an ODBC data source:

 * Start
  * Control Panel
   * Administrative Tools
    * Data Sources (ODBC)
     * User DSN
      * Add 
       * Driver: "Microsoft Access Driver (`*`.mdb)"
       * Data Source Name: "imos-ddb" (or whatever you wish to call it)
       * Select -> navigate to the ddb MS Access file

Once you have configured the ddb as an ODBC source, set the `toolbox.ddb` property (in `toolboxProperties.txt`) to the ODBC Data Source Name.

THe ddb is accessed via Java code, thus you must also compile this code, and let Matlab know where the Java classes are, by editing `classpath.txt`. 

==== Compiling the Java code ====

See the Building section on the DeploymentDatabase page for instructions on how to compile the Java DDB code. If you are unable to do this on your computer, [http://code.google.com/u/pauld.mccarthy/ email me] and I can send you the binary files. Alternatively, download the latest [WeeklySnapshots weekly snapshot], which contains the precompiled Java code.

==== Configuring Matlab ====

Assuming that matlab is installed in `C:\matlab`, and the toolbox is installed in `C:\imos-toolbox`, add the following line to the file `C:\matlab\toolbox\local\classpath.txt`:
{{{
C:\imos-toolbox\Java\bin
}}}

==== Starting the toolbox ====

The toolbox is currently started via the `flowManager` function, which prompts you for the data you wish to import, then loads and displays the data.

Start the toolbox like so:
{{{
>> flowManager
}}}


When you start the flow manager, you are first presented with the following dialog:

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_startDialog.png

Choose the field trip in which you are interested, and the directory which contains the raw data related to that field trip. You are able to use the top buttons to select a date range over which to filter the list of field trips to choose from.

Once you have selected a field trip and data directory, the toolbox will attempt to match up deployments with raw data files. You will then be presented with the following dialog:

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_dataFileStatusDialog.png

The top half of the dialog contains the list of all deployments related to the field trip; the bottom half contains the list of all files which were found, that correspond to the currently selected deployment.

Some of the deployments are highlighed:

 * A <font color="red">red deployment</font> indicates that the information in the ddb was invalid.
 * A *bold deployment* indicates that the toolbox could not find any files related to that deployment.
 * An _italicised deployment_ indicates that multiple files were found for that deployment. This will be the norm for e.g. ADCP instruments which store their data over multiple files. For other instruments (e.g. CTDs) this may indicate an error in the ddb, or in the data file naming scheme.

The dialog allows you to resolve any discrepancies between the information in ddb and the raw data files, by removing deployments, and adding/removing files to/from deployments.

When you are happy with the list of deployments for which data is to be imported, confirm the dialog; you will be presented with a progress bar while the data is imported:

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_importProgress.png

When the data has been imported, you will be presented with the main window, which allows you to view the sample data. Use the drop down menu at the top left to select the data set to view. The drop down menu on the top right will be used to choose what type of graph to use to display the data - currently only '!TimeSeries' is available. With the panel at the bottom left you can choose to omit parameters, and choose which dimension to graph against. 

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_main_window.png

By clicking on the 'Metadata' button on the left, you can also view and modify metadata:

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_metadata.png

==== Quality Control ====

By clicking on the 'Quality Control' button, you can choose to run the data through a set of automatic QC filters, which will automatically flag the data sets. The flags will be overlaid on the graphs:

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_qc_dialog.png

You can see that a few data points have been flagged. You can use the Matlab zoom mode to zoom in for a closer look.

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_main_window_zoom.png

When you deselect zoom mode, you can use click+drag a box around data points to select them. Use the left mouse button to select all data points, and the right mouse button to select already-flagged data points:

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_main_window_select.png

The selected data points are highlighted in white:

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_main_window_selected.png

Clicking on a set of selected data points will bring up a dialog, allowing you to set the QC flag on those points. The options will be different depending on which QC set you are using:

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_flag_dialog.png

When you confirm the flag dialog, you can see that the flag values for the selected data points have changed:

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_main_window_flagged.png

==== Export ====

Ay any time, you can click the 'Export' button to export the data sets to IMOS compliant NetCDF files. You can choose to export raw data, QC'd data or both:

http://imos-toolbox.googlecode.com/svn/wiki/images/gui_export.png