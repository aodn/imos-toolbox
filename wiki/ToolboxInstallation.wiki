#summary How to install the toolbox
#labels Featured,Support

<wiki:toc/>

= Toolbox Installation =

This page provides an overview of the steps required in order to get the IMOS Toolbox up and running.

== Standalone installation ==

=== Requirements ===

 * Windows (from XP to Seven either in 32bit or 64bit) or Linux 64bit operating system
 * A relevant Matlab Component Runtime.
 * A deployment database which contains some data (have a look at the deployment database [http://imos-toolbox.googlecode.com/svn/wiki/documents/deployment_database_conventions.pdf guidelines])
 * Java JRE (1.6 or newer) to be able to query the deployment database with the toolbox.
 * Microsoft Access 32bit if you use a 32bit operating system / Matlab, 64bit if you use a 64bit one (Optional, can be bypassed with UCanAccess, especially when using Linux)

=== Install Matlab Component Runtime ===

In order to run the standalone version of the Toolbox, you must first install the Matlab Component Runtime (MCR). You can download the proper MCR installer [http://data.aodn.org.au/IMOS/public/eMII/softwares/MCRInstaller/ here] :

 * imos-toolbox version 1.5 : MCRInstaller_7.10
 * imos-toolbox version 1.5.5 : MCRInstaller_7.12
 * imos-toolbox >= version 2.0 : MCRInstaller_7.14
 * imos-toolbox >= version 2.3 : MCRInstaller_8.0, choose according to your operating system.

You only need to run the installer once. For Windows, it comes as a straightforward executable, for Linux you need to unzip the archive, give executable permissions to the 'install' file and then execute it with root credentials. Then simply follow the instructions. During installation, you might be warned about requiring the .NET Framework - you may safely ignore this warning.

=== Install IMOS Toolbox ===

Download an archive from the [http://data.aodn.org.au/IMOS/public/eMII/softwares/imos-toolbox/ downloads] page. Most of the users should only use the last stable version : imos-toolbox-X.XX.zip. Unstable versions YY-MM-DD_unstable_snapshot.zip should be used for test purpose only and not in any case to deliver data to eMII. Extract the archive to a directory of your choice. 

=== Configure Deployment Database ===

Since imos-toolbox versions 2.0, in addition to the MS-Access deployment database (template provided in the [http://data.aodn.org.au/IMOS/public/eMII/softwares/imos-toolbox/ downloads] page), it is also possible to connect to any user-specific database providing its schema complies to a minimum requirements.

Limitations have been observed such that it is not possible to open the current 32bit version of the deployment database with a Microsoft Access software 64bit of version lower than 2013. It is possible to open it with Office 64bit 2013 though.

==== MS Access database ====

The toolbox is able to read the MS Access deployment database using:
 * Microsoft ODBC driver,
 * UCanAccess JDBC driver.

===== With Microsoft Access ODBC drivers =====

This solution is only recommended when the architecture version of Microsoft Access matches the one of Matlab or standalone binary architecture. For example if your Microsoft Access software is 32bit but your Matlab is 64bit then this won't work.

|| *Operating system* || *Microsof Access* || *Matlab or standalone binary* || *Compatibility* ||
|| 32bit || 32bit || 32bit || <font color="green">Ok</font> ||
|| 64bit || 32bit || 32bit || <font color="green">Ok</font> ||
|| 64bit || 32bit || 64bit || <font color="red">*KO*</font> ||
|| 64bit || 64bit || 32bit || <font color="red">*KO*</font> ||
|| 64bit || 64bit || 64bit || <font color="green">Ok</font> ||

The Microsoft Access software comes with a Microsoft Access ODBC driver which can be used to turn your MS Access file into an ODBC source following the described steps below:

 * Start
  * Control Panel
   * Administrative Tools
    * Data Sources (ODBC)
     * User DSN
      * Add 
       * Driver: "Microsoft Access Driver (`*`.mdb)"
       * Data Source Name: "imos-ddb" (or whatever you wish to call it)
       * Select -> navigate to the ddb MS Access file

Once you have configured the ddb as an ODBC source, set the `toolbox.ddb` property (in `toolboxProperties.txt`) to the ODBC Data Source Name.

===== With UCanAccess JDBC drivers =====

This is the preferred solution for Linux operating systems and when the above solution doesn't work. 

Simply set the `toolbox.ddb` property (in `toolboxProperties.txt`) to your MS Access file full path.

The main drawback here is the amount of Java Heap memory needed by the Java Virtual Machine and one may face a `java.lang.OutOfMemoryError: Java heap space` error message. The easiest fix is to tell Java to allocate sufficient heap space memory when the Java Virtual Machine starts up and this can be done in two ways:

 * In Matlab, via Preferences, in General -> Java Heap Memory and then set it to the maximum (2Gb is a minimum for AIMS database for example).
 * Add a java.opts file in the root directory of the toolbox, that is to say next to imosToolbox.m, which includes (without the double quotes) : "-Xmx2g". This way we're telling Java to allocate 2Gb of Heap memory. Then start either Matlab or any standalone binary executable from the root directory of the toolbox. This is the preferred method for use in standalone.

==== Other database ====

Your deployment database architecture has to follow a [DeploymentDatabase#Interface_requirements minimum interface requirements] to prevent the toolbox from crashing. Then to be able to query it through the toolbox, you must put the driver (.jar file) used to connect to it in the Java directory and set the relevant `toolbox.ddb.*` properties (in `toolboxProperties.txt`) properly.

=== Startup ===

Start the toolbox by double clicking on the relevant executable according to your operating system (if any doubt try Windows 32bit):

 * `imosToolbox_Win32.bat`  for Windows 32bit 
 * `imosToolbox_Win64.bat`  for Windows 64bit
 * `imosToolbox_Linux64.sh` for Linux 64bit

This is basically executing the relevant `imosToolbox.exe` but then will pause in the command window after exiting the toolbox so that you can have a look at any output message.

== Source installation ==

Only high level users should be interested in using the source code, for example users who would like to contribute to the development of the code. See [http://code.google.com/p/imos-toolbox/wiki/ContributeToTheCode how to contribute to the code] part.

=== Requirements ===

 * Windows (from XP to Seven either in 32bit or 64bit) or Linux 64bit operating system
 * Matlab (R2010b or newer)
 * A deployment database which contains some data (have a look at the deployment database [http://imos-toolbox.googlecode.com/svn/wiki/documents/deployment_database_conventions.pdf guidelines])
 * Java JRE (1.6 or newer) to be able to query the deployment database with the toolbox.
 * Microsoft Access 32bit if you use a 32bit operating system / Matlab, 64bit if you use a 64bit one (Optional, can be bypassed with UCanAccess, especially when using Linux)

=== Download and install ===

Download an archive from the [http://data.aodn.org.au/IMOS/public/eMII/softwares/imos-toolbox/ downloads] page. Most of the users should only use the last stable version : imos-toolbox-X.XX.zip. Unstable versions YY-MM-DD_unstable_snapshot.zip should be used for test purpose only and not in any case to deliver data to eMII. Extract the archive to a directory of your choice.

Before you can use the toolbox, you must configure the matlab path and deployment database.

=== Matlab path ===

The toolbox root, and every subdirectory within the toolbox root must be on the matlab path. In other words, you must add the following list of directories to your matlab path, either by setting the `MATLABPATH` environment variable, or, within matlab, using the 'Set Path' dialog, which is accessed via 'File'->'Set Path'. 

Assuming that the toolbox is installed in `C:\imos-toolbox`, you must add the following directories to the path:
  * `C:\imos-toolbox\`
    * `C:\imos-toolbox\AutomaticQC`
    * `C:\imos-toolbox\DDB`
    * `C:\imos-toolbox\FlowManager`
    * `C:\imos-toolbox\GUI`
    * `C:\imos-toolbox\Graph`
      * `C:\imos-toolbox\Graph\DepthProfile`
      * `C:\imos-toolbox\Graph\TimeSeries`
      * `C:\imos-toolbox\Graph\Transect`
    * `C:\imos-toolbox\IMOS`
    * `C:\imos-toolbox\NetCDF`
    * `C:\imos-toolbox\Parser`
    * `C:\imos-toolbox\Preprocessing`
    	* `C:\imos-toolbox\Preprocessing\Transform`
    * `C:\imos-toolbox\Seawater`
    * `C:\imos-toolbox\Util`

Be carefull not to keep links to several different toolbox versions in your Matlab path.

=== Deployment Database ===

As with a standalone installation, you must [#Configure_Deployment_Database configure your database].

Since version 2.3, it is not necessary to edit your Matlab `classpath.txt`. Any jar file in the Java directory and sub-directories is dynamically added to the matlab classpath whether the application is standalone or within matlab.

=== Startup ===

You should now be able to start Matlab and run the toolbox from any directory within Matlab and not necessarily the top level hierarchy of where the imosToolbox.m is, as long as the toolbox has been properly configured in the Matlab Path :
{{{
>> imosToolbox
}}}

This doesn't work for standalone though.

See the [UsingTheToolboxOverview overview] on using the toolbox to get started.

