#summary Specification of the automatic QC module
#labels Specification

<wiki:toc max_depth="2"/>

= Automatic Quality Control =

== Overview ==

One file exists for each automatic QC procedure. The procedures act as filters on a single vector of data. Data is passed through a chain of filters; this chain is configured by the user. The file/function name is of the form `[filter_name]QC.m` where `filter_name` is a unique name for the filter.

For example, the range checking filter file is titled `rangeQC.m`, and the function is called `rangeQC`.

When a filter is executed, it is passed a single column vector of a data set. If the data set is single dimensional (e.g. temperature at a fixed location), the filter is passed the entire data set. If the data set is multidimensional, however (e.g. temperature at a set of depths), the time series data from a single point in the dimensions (e.g. temperature at one of the depths) is passed to the filter.

Filter procedures are able to modify/remove data, or simply flag regions of data which do not pass through the filter. When a filter modifies/removes data, it should add a human readable entry to the `log` field in the `sample_data` struct, (see the [DataStructures data structures spec] for information on flagged data and log entries). 

== Function format ==

All auto-QC filter functions must adhere to the following format:

 `function [data, flags] = nameQC ( cal_data, data, k, varargin )`

where:
 * `cal_data` is a struct containing calibration and metadata information.
 * `data` is a column vector containing the data. As `data` is both an input and output argument, this implies that the QC procedure can modify the data.
 * `k` is the parameter number, which can be used as an index into the `cal_data.parameters` vector to retrieve parameter specific metadata.
 * `varargin` is a set of configuration parameters for the filter. If the filter has no parameters, this argument may be omitted. If the filter does have parameters, the filter *must* be able to be called without specifying any parameters, i.e. all of the parameters must be optional.
 * `flags` is a column vector, the same length as `data`, which contains QC flags for each point in the data.
 