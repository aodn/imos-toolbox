#summary Specification of the Toolbox's internal Matlab data structures.

<wiki:toc max_depth="2"/>

= Toolbox Data Structures =

Data is passed around the Toolbox in two Matlab structs:

 * `sample_data`: Contains the sample data.
 * `cal_data`: Contains calibration and metadata.

I made the choice to separate sample data from calibration data for coupling/cohesion reasons. It may end up being a better idea to just put all the data into one struct, but I'm going with the two for now.

== `sample_data` ==

`sample_data` is a vector of structs which contain sample data. Each element in the `sample_data` vector corresponds to one data process level (e.g. raw, auto-QC'd etc).

The `sample_data` struct elements have the following structure:
 * `sample_data`: struct
   * `level`: Data process level (String or Numeric?)
   * `time`: row vector of time (Numeric, as provided by the `datenum` function)
   * `depth`: Scalar or vector of depth (Numeric)
   * `latitude`: Scalar or vector of latitude.
   * `longitude`: Scalar or vector of longitude.
   * `parameters`: vector of structs
     * `name`: IMOS compliant parameter name (String)
     * `comment`: Optional human readable comment (String)
     * `data`: row vector of data (Numeric)
     * `flags`: matrix of flagged data ranges - indices into the `data` vector (Numeric,Numeric,String ?)

== `cal_data` ==

The `cal_data` struct contains instrument/deployment metadata information, and instrument calibration information (if this information is available). The contents of `cal_data`  may be different depending on how much calibration information is available in the raw data file and the deployment database.

A minimal `cal_data` struct should contain the following:
 * `cal_data`
   * `instrument_make`: e.g. 'Seabird (String)
   * `instrument_model`: e.g. 'SBE37' (String)
   * `instrument_firmware`: e.g. '2.6a' (String)
   * `instrument_serial`: e.g. '6082' (String)
   * `in_water_time`: Time that the instrument was first in the water. This time is used to determine the time of the first valid sample (Numeric)
   * `out_water_time`: Time that the instrument was first out of the water. This time is used to determine the time of the last valid sample (Numeric)
   * `parameters`: String
     * `name`: IMOS compliant parameter name (String)
     * `max_value`: Minimum allowable value (Numeric)
     * `min_value`: Maximum allowable value (Numeric)